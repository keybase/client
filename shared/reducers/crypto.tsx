import * as Container from '../util/container'
import * as TeamBuildingConstants from '../constants/team-building'
import type * as TeamBuildingTypes from '../constants/types/team-building'
import type * as TeamBuildingGen from '../actions/team-building-gen'
import {editTeambuildingDraft} from './team-building'
import {teamBuilderReducerCreator} from '../team-building/reducer-helper'

type Actions = TeamBuildingGen.Actions
type State = {
  teamBuilding: TeamBuildingTypes.TeamBuildingSubState
}
const initialState = {
  teamBuilding: TeamBuildingConstants.makeSubState(),
}

// TODO team building pull out

export default Container.makeReducer<Actions, State>(initialState, {
  ['common:resetStore']: () => {},
  // Encrypt: Handle team building when selecting keybase users
  ...teamBuilderReducerCreator<State>(
    (draftState: Container.Draft<State>, action: TeamBuildingGen.Actions) => {
      const val = editTeambuildingDraft('crypto', draftState.teamBuilding, action)
      if (val !== undefined) {
        draftState.teamBuilding = val
      }
    }
  ),
})
