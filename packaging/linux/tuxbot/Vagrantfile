Vagrant.configure("2") do |config|
  config.vm.box = "debian/buster64"
  config.vm.provider "virtualbox" do |vb|
    vb.memory = "24576"
  end
  config.vm.provision "file", source: "~/go/src/github.com/keybase/client/packaging/linux/tuxbot/ssh_config",
    destination: "~/.ssh/config"
  config.vm.provision "file", source: "~/go/src/github.com/keybase/client/packaging/linux/tuxbot/ssh_known_hosts",
    destination: "~/.ssh/known_hosts"
  config.vm.provision "shell", inline: "> /etc/environment", run: "always"
  config.vm.provision "shell", inline: "echo \"GNUPGHOME=/tmp\" >> /etc/environment", run: "always"
  config.vm.provision "shell", inline: "echo \"SECRETS_TEAM=#{ENV['SECRETS_TEAM']}\" >> /etc/environment", run: "always"
  config.vm.provision "shell", inline: "echo \"SECRETS_REPO=#{ENV['SECRETS_REPO']}\" >> /etc/environment", run: "always"
  config.vm.provision "shell", inline: "echo \"CHAT_TEAM=#{ENV['CHAT_TEAM']}\" >> /etc/environment", run: "always"
  config.vm.provision "shell", inline: "echo \"CHAT_CHANNEL=#{ENV['CHAT_CHANNEL']}\" >> /etc/environment", run: "always"
  config.vm.provision "shell", path: "provision_tuxbot_root", privileged: true
  config.vm.provision "shell", path: "provision_tuxbot_user", privileged: false
end
